<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>TP Bioinformatique : Classification taxonomique de sÃ©quences 16S rDNA</title>
  <style>
    body {
      font-family: "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      margin: 20px;
      padding: 20px;
      background-color: #f2f2f2;
      color: #333;
    }
    h1, h2, h3, h4, h5, h6 {
      color: #222;
    }
    p {
      color: #444;
    }
    ul, ol {
      margin-left: 20px;
    }
    pre, code {
      background-color: #eee;
      border: 1px solid #ccc;
      padding: 10px;
      display: block;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 20px;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 8px;
      text-align: left;
    }
    a {
      color: #007acc;
      text-decoration: none;
    }
    a:hover {
      text-decoration: underline;
    }
    blockquote {
      border-left: 4px solid #ccc;
      padding-left: 1em;
      margin: 1em 0;
      color: #666;
    }
    hr {
      border: none;
      border-top: 2px solid #ccc;
      margin: 20px 0;
    }
  </style>
</head>
<body>
  <h1>ğŸ§¬ TP Bioinformatique : Classification taxonomique de sÃ©quences 16S rDNA</h1>
  <hr/>

  <h2>ğŸ¯ Objectifs pÃ©dagogiques</h2>
  <p>Dans ce TP, vous allez apprendre Ã  :</p>
  <ul>
    <li>Utiliser des outils bioinformatiques pour analyser des donnÃ©es de sÃ©quenÃ§age 16S rDNA.</li>
    <li>Identifier les microorganismes prÃ©sents dans des Ã©chantillons alimentaires.</li>
    <li>Visualiser la composition microbienne Ã  l'aide d'outils comme <strong>Kraken2</strong> et <strong>Krona</strong>.</li>
  </ul>
  <hr/>

  <h2>ğŸ§ª Contexte</h2>
  <p>Les sÃ©quences 16S rDNA sont des marqueurs molÃ©culaires trÃ¨s utilisÃ©s pour identifier les bactÃ©ries dans des Ã©chantillons environnementaux, cliniques ou alimentaires.<br/>
  Ici, nous Ã©tudions <strong>trois Ã©chantillons alimentaires suspects de contamination microbienne</strong>.<br/>
  Lâ€™analyse 16S permet de :</p>
  <ul>
    <li>RÃ©vÃ©ler la <strong>diversitÃ© bactÃ©rienne</strong> dans un produit</li>
    <li>Mettre en Ã©vidence des <strong>contaminations</strong> dâ€™origine alimentaire</li>
    <li>Contribuer au <strong>contrÃ´le qualitÃ©</strong> dans lâ€™industrie agroalimentaire</li>
  </ul>
  <hr/>

  <h2>ğŸ§¬ Pourquoi le gÃ¨ne 16S rDNA ?</h2>
  <p>Le gÃ¨ne 16S rDNA code pour une sous-unitÃ© du ribosome chez les procaryotes. Il possÃ¨de :</p>
  <ul>
    <li>ğŸ”’ Des rÃ©gions conservÃ©es (identiques entre espÃ¨ces) â†’ pour lâ€™alignement</li>
    <li>ğŸ§© Des rÃ©gions variables (diffÃ©rentes selon les espÃ¨ces) â†’ pour lâ€™identification</li>
  </ul>
  <p>Cela en fait un excellent marqueur molÃ©culaire pour lâ€™identification des bactÃ©ries.</p>
  <hr/>

  <h2>ğŸ§° Comment fait-on la classification taxonomique Ã  partir dâ€™une sÃ©quence 16S ?</h2>
  <p>Voici les Ã©tapes clÃ©s :</p>
  <ol>
    <li>ğŸ”¬ Extraction de lâ€™ADN et sÃ©quenÃ§age des amplicons 16S (ex. : via Oxford Nanopore, Illuminaâ€¦)</li>
    <li>ğŸ’» Nettoyage et prÃ©paration des donnÃ©es</li>
    <li>ğŸ§  Comparaison des sÃ©quences avec une base de donnÃ©es de rÃ©fÃ©rence (ex : SILVA, Greengenes, RDP)</li>
    <li>ğŸ“Š Attribution dâ€™un taxon (nom scientifique) Ã  chaque sÃ©quence selon sa similaritÃ©</li>
    <li>ğŸŒ Visualisation des rÃ©sultats (ex. : diagrammes, Krona)</li>
  </ol>
  <hr/>

  <h2>ğŸ“¦ PrÃ©requis</h2>
  <p>Avant de commencer, assurez-vous que les outils suivants sont installÃ©s sur votre systÃ¨me (Linux ou WSL recommandÃ©) :</p>
  <h3>ğŸ”§ Installation des outils</h3>
  <pre><code># Mise Ã  jour systÃ¨me
sudo apt update && sudo apt upgrade -y

# Installation des outils nÃ©cessaires
sudo apt install -y minimap2 samtools kraken2 python3-pip git wget curl

# Installation de Krona (outil de visualisation interactive)
wget https://raw.githubusercontent.com/etibiri/etibiri.github.io/main/scripts/Krona_install.sh
bash Krona_install.sh
source ~/.bashrc
  </code></pre>
  <hr/>

  <h2>ğŸ“ Ã‰tape 1 : PrÃ©paration des donnÃ©es</h2>
  <p>TÃ©lÃ©chargez les donnÃ©es de dÃ©monstration fournies par Oxford Nanopore.</p>
  <pre><code>wget -c https://ont-exd-int-s3-euwst1-epi2me-labs.s3.amazonaws.com/wf-16s/wf-16s-demo.tar.gz
tar -xzvf wf-16s-demo.tar.gz

# Organisation du projet
mkdir -p ~/TP-G0/DATA
cp -r ~/wf-flu-demo/test_data ~/TP-G0/DATA
  </code></pre>
  <hr/>

  <h2>ğŸ§¬ Ã‰tape 2 : PrÃ©parer la base de donnÃ©es taxonomique</h2>
  <h3>ğŸ§  Comprendre la classification taxonomique</h3>
  <p><em>ğŸ” Quâ€™est-ce que la classification taxonomique ?</em></p>
  <p>La classification taxonomique est une mÃ©thode utilisÃ©e pour organiser les Ãªtres vivants (plantes, animaux, micro-organismes, etc.) en groupes hiÃ©rarchiques basÃ©s sur leurs caractÃ©ristiques gÃ©nÃ©tiques et Ã©volutives.<br/>
  Elle permet de nommer, identifier et regrouper les organismes selon des catÃ©gories standardisÃ©es.</p>
  <p>Dans le cadre de la bioinformatique, cette classification est faite Ã  partir des sÃ©quences dâ€™ADN. Lâ€™analyse du gÃ¨ne 16S rDNA, prÃ©sent dans toutes les bactÃ©ries, est une mÃ©thode trÃ¨s puissante pour :</p>
  <ul>
    <li>Identifier les espÃ¨ces prÃ©sentes dans un Ã©chantillon complexe (ex. : sol, intestin, aliment contaminÃ©)</li>
    <li>Comparer les communautÃ©s microbiennes entre diffÃ©rents environnements</li>
    <li>Ã‰tudier la diversitÃ© microbienne</li>
  </ul>
  <hr/>

  <h3>ğŸ’¡ Exemple simple dâ€™arbre taxonomique</h3>
  <pre><code>RÃ¨gne       : Bacteria  
â””â”€â”€ Phylum : Proteobacteria  
     â””â”€â”€ Classe : Gammaproteobacteria  
          â””â”€â”€ Ordre : Enterobacterales  
               â””â”€â”€ Famille : Enterobacteriaceae  
                    â””â”€â”€ Genre : Escherichia  
                         â””â”€â”€ EspÃ¨ce : Escherichia coli
  </code></pre>
  <hr/>

  <h3>ğŸ”¹ TÃ©lÃ©charger une base 16S (SILVA) compatible minimap2</h3>
  <pre><code>mkdir -p ~/TP-G0/DB
cd ~/TP-G0/DB

# TÃ©lÃ©chargement de la base SILVA 16S avec annotation taxonomique
wget https://zenodo.org/record/3986799/files/silva_nr99_v138_wSpecies_train_set.fa.gz
gunzip -k silva_nr99_v138_wSpecies_train_set.fa.gz

# Nettoyage des headers pour minimap2
awk '/^>/{split($0,a," "); print a[1]; next} {print}' silva_nr99_v138_wSpecies_train_set.fa | sed 's/[>;]//g' > database_clean.fasta
  </code></pre>
  <h3>ğŸ”¹ Construire une base Kraken2</h3>
  <pre><code>cd ~/TP-G0/DB
kraken2-build --special silva --db kraken2_16S_db
kraken2-build --build --db kraken2_16S_db
  </code></pre>
  <p>â³ <strong>Note :</strong> Cette Ã©tape peut prendre du temps (~20â€“30 minutes selon votre machine).</p>
  <hr/>

  <h2>ğŸ” Ã‰tape 3 : Alignement et classification</h2>
  <h3>Alignement de sÃ©quences</h3>
  <p>ğŸ§  <strong>DÃ©finition :</strong></p>
  <p>Lâ€™alignement est une technique bioinformatique qui permet de comparer une sÃ©quence dâ€™ADN Ã  une ou plusieurs sÃ©quences de rÃ©fÃ©rence (gÃ©nÃ©ralement issues dâ€™une base de donnÃ©es).
  Lâ€™objectif est de trouver les rÃ©gions similaires entre les sÃ©quences afin dâ€™identifier leur origine biologique.</p>
  <p><strong>Pourquoi aligner une sÃ©quence ?</strong></p>
  <ul>
    <li>Pour identifier un micro-organisme Ã  partir de son ADN.</li>
    <li>Pour localiser des mutations ou des rÃ©gions variables.</li>
    <li>Pour comparer des sÃ©quences d'espÃ¨ces diffÃ©rentes ou d'individus.</li>
  </ul>
  <p><strong>Exemple dâ€™outil : minimap2</strong></p>
  <ul>
    <li>UtilisÃ© pour aligner rapidement des lectures longues (ONT, PacBio) sur une base de donnÃ©es.</li>
    <li>Produit un fichier .sam ou .bam contenant les positions des alignements.</li>
  </ul>
  <p><strong>Analogie :</strong> Imaginez que vous ayez un mot inconnu et un dictionnaire : lâ€™alignement revient Ã  chercher le mot qui ressemble le plus dans le dictionnaire.</p>
  <h3>ğŸ’  Approche 1 : Alignement avec Minimap2</h3>
  <pre><code>mkdir -p ~/TP-G0/MAPPING
cd ~/TP-G0/MAPPING

# Indexation de la base
minimap2 -d database_clean.mmi ~/TP-G0/DB/database_clean.fasta

# Alignement des sÃ©quences des 3 Ã©chantillons
minimap2 -ax map-ont database_clean.mmi ~/TP-G0/DATA/test_data/barcode01/*.fastq.gz > barcode01_alignment.sam
minimap2 -ax map-ont database_clean.mmi ~/TP-G0/DATA/test_data/barcode02/*.fastq.gz > barcode02_alignment.sam
minimap2 -ax map-ont database_clean.mmi ~/TP-G0/DATA/test_data/barcode03/*.fastq.gz > barcode03_alignment.sam

# Conversion SAM en BAM et tri
samtools view -Sb barcode02_alignment.sam | samtools sort > barcode02_alignment.sorted.bam
samtools view -Sb barcode03_alignment.sam | samtools sort > barcode03_alignment.sorted.bam

samtools index barcode01_alignment.sorted.bam
samtools index barcode02_alignment.sorted.bam
samtools index barcode03_alignment.sorted.bam
  </code></pre>
  <h3>ğŸ’  Approche 2 : Classification avec Kraken2</h3>
  <pre><code>mkdir -p ~/TP-G0/KRAKEN2
cd ~/TP-G0/KRAKEN2

# Analyse de chaque Ã©chantillon avec Kraken2
kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report barcode01_kraken_report.txt --output barcode01_kraken_output.tsv ~/TP-G0/DATA/test_data/barcode01/*.fastq.gz
kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report barcode02_kraken_report.txt --output barcode02_kraken_output.tsv ~/TP-G0/DATA/test_data/barcode02/*.fastq.gz
kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report barcode03_kraken_report.txt --output barcode03_kraken_output.tsv ~/TP-G0/DATA/test_data/barcode03/*.fastq.gz
  </code></pre>
  <hr/>

  <h2>ğŸ“Š Ã‰tape 4 : GÃ©nÃ©rer un profil taxonomique</h2>
  <h3>GÃ©nÃ©rer les fichiers complets avec zÃ©ros</h3>
  <pre><code>kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report-zero-counts --output barcode01_output.tsv ~/TP-G0/DATA/test_data/barcode01/*.fastq.gz
kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report-zero-counts --output barcode02_output.tsv ~/TP-G0/DATA/test_data/barcode02/*.fastq.gz
kraken2 --db ~/TP-G0/DB/kraken2_16S_db --report-zero-counts --output barcode03_output.tsv ~/TP-G0/DATA/test_data/barcode03/*.fastq.gz
  </code></pre>
  <hr/>

  <h2>ğŸŒ Ã‰tape 5 : Visualisation avec Krona</h2>
  <p>Krona gÃ©nÃ¨re une page HTML interactive montrant les taxons dÃ©tectÃ©s.</p>
  <pre><code>ktImportTaxonomy barcode01_kraken_report.txt -o barcode01_krona_output.html
ktImportTaxonomy barcode02_kraken_report.txt -o barcode02_krona_output.html
ktImportTaxonomy barcode03_kraken_report.txt -o barcode03_krona_output.html
  </code></pre>
  <p>Ouvrez les fichiers <code>.html</code> dans un navigateur pour explorer la diversitÃ© microbienne par Ã©chantillon.</p>
  <hr/>

  <h2>âœ… RÃ©sultats attendus</h2>
  <ul>
    <li>Fichiers dâ€™alignement <code>.bam</code> par Ã©chantillon</li>
    <li>Fichiers Kraken2 : <code>.tsv</code>, <code>.txt</code></li>
    <li>Graphiques Krona interactifs : <code>barcode0X_krona_output.html</code></li>
  </ul>
  <hr/>

  <h2>ğŸ“š Ressources utiles</h2>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Titre / Lien</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ğŸŒ Site</td>
        <td><a href="https://www.ncbi.nlm.nih.gov/taxonomy" target="_blank">NCBI Taxonomy Database</a></td>
        <td>Base de donnÃ©es taxonomique utilisÃ©e par les outils bioinformatiques</td>
      </tr>
      <tr>
        <td>ğŸ§  Tutoriel</td>
        <td><a href="https://www.ebi.ac.uk/training/online/course/introduction-taxonomy" target="_blank">Introduction to Taxonomic Classification â€“ EMBL-EBI</a></td>
        <td>Cours en ligne interactif pour dÃ©butants</td>
      </tr>
      <tr>
        <td>ğŸ“˜ Livre</td>
        <td>*Bioinformatics for Beginners* â€“ Wiley (2016)</td>
        <td>Introduction aux bases de la bioinformatique (chapitres sur la classification 16S)</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1128/AEM.01541-09" target="_blank">Schloss et al., 2009 â€“ Introducing mothur</a></td>
        <td>Article fondamental sur lâ€™analyse 16S et la communautÃ© microbienne</td>
      </tr>
      <tr>
        <td>ğŸ“ MOOC</td>
        <td><a href="https://www.coursera.org/specializations/genomic-data-science" target="_blank">Coursera - Genomic Data Science</a></td>
        <td>Cours incluant lâ€™analyse 16S et outils de classification</td>
      </tr>
      <tr>
        <td>ğŸ“˜ Livre</td>
        <td>*Bioinformatics Algorithms* â€“ Phillip Compeau &amp; Pavel Pevzner (<a href="https://www.coursera.org/specializations/bioinformatics" target="_blank">Coursera/UCSD</a>)</td>
        <td>Couvre lâ€™alignement, les arbres phylogÃ©nÃ©tiques et la taxonomie</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1093/bioinformatics/bty191" target="_blank">Minimap2: pairwise alignment for nucleotide sequences â€“ Li, 2018</a></td>
        <td>Article scientifique de rÃ©fÃ©rence sur minimap2</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1186/gb-2014-15-3-r46" target="_blank">Kraken: Ultrafast Metagenomic Sequence Classification â€“ Wood et Salzberg, 2014</a></td>
        <td>Base mÃ©thodologique de Kraken/Kraken2</td>
      </tr>
      <tr>
        <td>ğŸ§  Tutoriel</td>
        <td><a href="https://www.ebi.ac.uk/training/online/course/introduction-sequence-search-and-alignment" target="_blank">EBI Training â€“ Sequence alignment</a></td>
        <td>Cours interactif pour dÃ©buter avec lâ€™alignement</td>
      </tr>
      <tr>
        <td>ğŸ“ MOOC</td>
        <td><a href="https://www.mooc-list.com/tags/metagenomics" target="_blank">Coursera â€“ Metagenomics</a></td>
        <td>Couvre alignement, classification, diversitÃ© microbienne</td>
      </tr>
    </tbody>
  </table>
  <hr/>

  <h2>ğŸ’¡ Astuce pour aller plus loin</h2>
  <p>Vous pouvez Ã©galement explorer :</p>
  <ul>
    <li>Lâ€™export de vos rÃ©sultats au format <code>.csv</code> pour analyse sous Excel/R ou Python</li>
    <li>La comparaison des profils microbiens entre les trois Ã©chantillons</li>
    <li>Lâ€™application du mÃªme pipeline sur le 4Ã¨me Ã©chantillon ou d'autres donnÃ©es 16S disponibles dans les banques de donnÃ©es</li>
  </ul>
  <hr/>

  <h2>ğŸ“š Ressources pÃ©dagogiques pour approfondir</h2>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Titre / Lien</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>ğŸŒ Site</td>
        <td><a href="https://www.ncbi.nlm.nih.gov/taxonomy" target="_blank">NCBI Taxonomy Database</a></td>
        <td>Base de donnÃ©es taxonomique utilisÃ©e par les outils bioinformatiques</td>
      </tr>
      <tr>
        <td>ğŸ§  Tutoriel</td>
        <td><a href="https://www.ebi.ac.uk/training/online/course/introduction-taxonomy" target="_blank">Introduction to Taxonomic Classification â€“ EMBL-EBI</a></td>
        <td>Cours en ligne interactif pour dÃ©butants</td>
      </tr>
      <tr>
        <td>ğŸ“˜ Livre</td>
        <td>*Bioinformatics for Beginners* â€“ Wiley (2016)</td>
        <td>Introduction aux bases de la bioinformatique (chapitres sur la classification 16S)</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1128/AEM.01541-09" target="_blank">Schloss et al., 2009 â€“ Introducing mothur</a></td>
        <td>Article fondamental sur lâ€™analyse 16S et la communautÃ© microbienne</td>
      </tr>
      <tr>
        <td>ğŸ“ MOOC</td>
        <td><a href="https://www.coursera.org/specializations/genomic-data-science" target="_blank">Coursera - Genomic Data Science</a></td>
        <td>Cours incluant lâ€™analyse 16S et outils de classification</td>
      </tr>
      <tr>
        <td>ğŸ“˜ Livre</td>
        <td>*Bioinformatics Algorithms* â€“ Phillip Compeau &amp; Pavel Pevzner (<a href="https://www.coursera.org/specializations/bioinformatics" target="_blank">Coursera/UCSD</a>)</td>
        <td>Couvre lâ€™alignement, les arbres phylogÃ©nÃ©tiques et la taxonomie</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1093/bioinformatics/bty191" target="_blank">Minimap2: pairwise alignment for nucleotide sequences â€“ Li, 2018</a></td>
        <td>Article scientifique de rÃ©fÃ©rence sur minimap2</td>
      </tr>
      <tr>
        <td>ğŸ“„ Article</td>
        <td><a href="https://doi.org/10.1186/gb-2014-15-3-r46" target="_blank">Kraken: Ultrafast Metagenomic Sequence Classification â€“ Wood et Salzberg, 2014</a></td>
        <td>Base mÃ©thodologique de Kraken/Kraken2</td>
      </tr>
      <tr>
        <td>ğŸ§  Tutoriel</td>
        <td><a href="https://www.ebi.ac.uk/training/online/course/introduction-sequence-search-and-alignment" target="_blank">EBI Training â€“ Sequence alignment</a></td>
        <td>Cours interactif pour dÃ©buter avec lâ€™alignement</td>
      </tr>
      <tr>
        <td>ğŸ“ MOOC</td>
        <td><a href="https://www.mooc-list.com/tags/metagenomics" target="_blank">Coursera â€“ Metagenomics</a></td>
        <td>Couvre alignement, classification, diversitÃ© microbienne</td>
      </tr>
    </tbody>
  </table>

<!-- Pied de page -->
  <footer class="footer">
    <p>&copy; 2025 Ezechiel B. TIBIRI. Tous droits rÃ©servÃ©s.</p>
    <p> BURKINA FASO<p>
    <p>Site hÃ©bergÃ© sur <a href="https://github.com/etibiri" target="_blank">GitHub</a>.</p>
  </footer>
</body>
</html>

